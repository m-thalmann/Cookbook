@use 'sass:map';
@use 'theme/variables' as *;

@mixin apply() {
  @each $theme, $variables in $themes {
    $app-theme: map.get($variables, 'theme');

    $additional-variables: (
      'background': mat-color(map.get($app-theme, 'background'), 'background'),
      'foreground': mat-color(map.get($app-theme, 'foreground'), 'text'),
    );

    $variables: map.merge($variables, $additional-variables);

    @if ($theme == $default-theme) {
      :host-context(html:not([class^='theme-'])) &,
      :host-context(html.theme-#{$theme}) & {
        @content ($variables);
      }
    } @else {
      :host-context(html.theme-#{$theme}) & {
        @content ($variables);
      }
    }
  }
}
